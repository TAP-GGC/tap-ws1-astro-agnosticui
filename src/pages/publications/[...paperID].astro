---
// Style Imports
import '../../styles/global.css';
import '@fontsource/source-sans-pro';
import '@fontsource/pixelify-sans';
import '@fontsource/ibm-plex-mono';
import '@fontsource/work-sans';
import '@fontsource/cormorant-garamond';
import '@fontsource/spectral';
import '@fontsource/crimson-pro';
import '@fontsource/alfa-slab-one';

import "agnostic-vue/dist/common.properties.min.css";
import "agnostic-vue/dist/common.resets.min.css";
import "agnostic-vue/dist/common.utilities.min.css";
import "agnostic-vue/dist/opinions.min.css";

// Component Imports
import "agnostic-vue/dist/index.css";
import TAPDefaultLayout from "../../layouts/default.astro";
import Crumbs from '../../components/Crumbs.vue';
// Read from content collection
import { getCollection } from 'astro:content';
//projects
import projectIds from '../../components/astro/ProjectIds';
import ProjectCard from '../../components/ProjectCard.vue';
//faculty
import FacultyCard from '../../components/FacultyCard.vue';
import facultyIds from '../../components/astro/FacultyIds';
//students
import studentIds from '../../components/astro/StudentIds';
import StudentCard from '../../components/StudentCard.vue';

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const papers = await getCollection('publications')
  return papers.map(entry => ({
    params: { paperID: `${entry.data.id}` }, 
    props: { entry },
  }));
}
// 2. For your template, you can get the entry directly from the prop
const { entry } = Astro.props;
const { paperID } = Astro.params;
const { Content } = await entry.render();
   

//BreadCrumb variables
const publicationName = entry.data.title;
const publicationTag = entry.data.tags;

// Page title
let title = `${entry.data.title} (${entry.data.postDate.toDateString()}) - GGC Technology Ambassadors Program`;

---
<TAPDefaultLayout title={title}>
	<Crumbs pageType="publication" pageUrl=`/publications/${paperID}` />
  <div class="blog">
    <h1 class="projectTitle">{entry.data.shortTitle ? entry.data.shortTitle : entry.data.title }</h1>
    
    <Content />

    {entry.data?.projects?.[0] && (
      <h2>Project:  </h2>
      <section class="sectionCards">
        {entry.data.projects.map((project_id) => (      
          <ProjectCard item={projectIds[project_id]} />
        ))}
      </section>
    )}

    {entry.data?.instructors?.[0] && entry.data?.students?.[0] && (
      <h2>Authors: </h2>
      <section class="sectionCards">
        {entry.data.students.map((student) => (      
          <StudentCard item={studentIds[student]}/>
        ))}
        {entry.data.instructors.map((instructor) => (      
          <FacultyCard item={facultyIds[instructor]} />
        ))}
      </section>
    )}
  </div>

  
</TAPDefaultLayout>

<style>
.sectionCards{
  flex-wrap: wrap;
  flex-shrink: 1;
  flex-grow: 1;
  flex-direction: row;
  display: flex;
  justify-content: space-evenly;
}

</style>